{
    "name": "BIDFLOW Development (Ubuntu)",
    "image": "mcr.microsoft.com/devcontainers/base:ubuntu-22.04",

    "features": {
          "ghcr.io/devcontainers/features/node:1": {
                  "version": "20",
                  "nodeGypDependencies": true
          },
          "ghcr.io/devcontainers/features/github-cli:1": {},
          "ghcr.io/devcontainers/features/docker-in-docker:2": {},
          "ghcr.io/devcontainers-contrib/features/pnpm:2": {
                  "version": "latest"
          },
          "ghcr.io/devcontainers/features/python:1": {
                  "version": "3.11"
          },
          "ghcr.io/devcontainers/features/git:1": {},
          "ghcr.io/devcontainers/features/common-utils:2": {
                  "installZsh": true,
                  "configureZshAsDefaultShell": true,
                  "installOhMyZsh": true
          }
    },

    "customizations": {
          "vscode": {
                  "extensions": [
                            "esbenp.prettier-vscode",
                            "dbaeumer.vscode-eslint",
                            "bradlc.vscode-tailwindcss",
                            "prisma.prisma",
                            "ms-vscode.vscode-typescript-next",
                            "formulahendry.auto-rename-tag",
                            "christian-kohler.path-intellisense",
                            "mikestead.dotenv",
                            "eamodio.gitlens",
                            "usernamehw.errorlens",
                            "ms-azuretools.vscode-docker",
                            "ms-playwright.playwright"
                  ],
                  "settings": {
                            "editor.formatOnSave": true,
                            "editor.defaultFormatter": "esbenp.prettier-vscode",
                            "typescript.preferences.importModuleSpecifier": "relative",
                            "terminal.integrated.defaultProfile.linux": "zsh",
                            "editor.codeActionsOnSave": {
                                        "source.fixAll.eslint": "explicit"
                            }
                  }
          },
          "codespaces": {
                  "openFiles": [
                            "CLAUDE.md",
                            ".claude/CLAUDE.md"
                  ]
          }
    },

    "postCreateCommand": "pnpm install && pnpm run typecheck",

    "postStartCommand": "echo 'ðŸš€ BIDFLOW Dev Environment Ready!'",

    "forwardPorts": [3010, 54321, 54322],

    "portsAttributes": {
          "3010": {
                  "label": "BIDFLOW Dev Server",
                  "onAutoForward": "openBrowser"
          },
          "54321": {
                  "label": "Supabase API",
                  "onAutoForward": "silent"
          },
          "54322": {
                  "label": "Supabase Studio",
                  "onAutoForward": "silent"
          }
    },

    "remoteEnv": {
          "NODE_ENV": "development",
          "PNPM_HOME": "/home/vscode/.local/share/pnpm",
          "PATH": "${containerEnv:PNPM_HOME}:${containerEnv:PATH}"
    },

    "containerEnv": {
          "NEXT_PUBLIC_SUPABASE_URL": "${localEnv:NEXT_PUBLIC_SUPABASE_URL}",
          "NEXT_PUBLIC_SUPABASE_ANON_KEY": "${localEnv:NEXT_PUBLIC_SUPABASE_ANON_KEY}",
          "SUPABASE_SERVICE_ROLE_KEY": "${localEnv:SUPABASE_SERVICE_ROLE_KEY}"
    },

    "mounts": [
          "source=${localEnv:HOME}/.ssh,target=/home/vscode/.ssh,type=bind,consistency=cached"
    ],

    "remoteUser": "vscode"
}
